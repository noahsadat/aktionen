<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <title>Cross-Selling Generator</title>
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Cross-Selling Generator</h1>
        <p>Tool zur Generierung einer Cross-Selling-Excel-Datei mit der MÃ¶glichkeit, den Kategorie-Rang der Cross-Seller zu hinterlegen.</p>
        <div class="mb-3">
            <label for="excelFile" class="form-label">Upload Excel File</label>
            <input class="form-control" type="file" id="excelFile" accept=".xlsx, .xls">
        </div>
        <div class="mb-3">
            <label for="categoryRank" class="form-label">Kategorie-Rang</label>
            <input class="form-control" type="text" id="categoryRank">
        </div>
        <button id="processButton" class="btn btn-primary">Process and Download</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        document.getElementById('processButton').addEventListener('click', function() {
            const fileInput = document.getElementById('excelFile');
            const categoryRank = document.getElementById('categoryRank').value;
            const file = fileInput.files[0];
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(sheet, {header: 1});
                    
                    const columnA = jsonData.map(row => row[0]).filter(Boolean);
                    const resultData = [];

                    for (let i = 0; i < columnA.length; i++) {
                        for (let j = 0; j < columnA.length; j++) {
                            if (i !== j) {
                                resultData.push([columnA[i], columnA[j], categoryRank, 'ATAC2']);
                            }
                        }
                    }

                    const ws = XLSX.utils.aoa_to_sheet([['Artikel', 'Cross-Sell-Artikel', 'Kategorie-Rang', 'Wertelisteneintrag-ID'], ...resultData]);
                    const wb = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(wb, ws, "Cross-Selling");
                    
                    XLSX.writeFile(wb, 'cross_selling_result.xlsx');
                };
                reader.readAsArrayBuffer(file);
            } else {
                alert('Please select an Excel file first.');
            }
        });
    </script>
</body>
</html>